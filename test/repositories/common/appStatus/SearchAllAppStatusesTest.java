package repositories.common.appStatus;

import models.common.AppStatus;
import org.junit.Test;
import play.test.WithApplication;

import java.util.Date;
import java.util.HashMap;

import static junit.framework.TestCase.assertEquals;
import static junit.framework.TestCase.assertNull;
import static org.hibernate.validator.internal.util.Contracts.assertNotNull;
import static play.test.Helpers.fakeApplication;
import static play.test.Helpers.inMemoryDatabase;
import static play.test.Helpers.running;

/**
 * Created by adrian on 17.07.16.
 */
public class SearchAllAppStatusesTest extends WithApplication implements I_AllAppStatusesSearchable {

    public String appStatusSampleName = "sample";
    public String appStatusSampleDescription = "sampleDescription";

    public int currentSize;
    public int exceptedSize = 1;

    @Test
    public void searchAllNullExecutionTest(){

        running(fakeApplication(inMemoryDatabase("test")), () -> {

            HashMap<String, AppStatus> appStatusesList = searchAll();
            assertNull(appStatusesList);

        });

    }

    @Test
    public void searchAllTest(){

        running(fakeApplication(inMemoryDatabase()), () -> {

            createSampleStatus();
            HashMap<String, AppStatus> appStatusesList = searchAll();
            currentSize = appStatusesList.size();

            assertNotNull(appStatusesList);
            assertEquals(currentSize, exceptedSize);
            assertNotNull(appStatusesList.get("sample"));
            assertEquals(appStatusesList.get("sample").appStatusName, appStatusSampleName);
            assertEquals(appStatusesList.get("sample").appStatusDescription, appStatusSampleDescription);

        });

    }

    @Override
    public HashMap<String, AppStatus> searchAll() {

        SearchAllAppStatuses searchAllAppStatus = new SearchAllAppStatuses();
        return searchAllAppStatus.searchAll();

    }

    public void createSampleStatus(){

        AppStatus appStatus = new AppStatus();
        appStatus.appStatusName = appStatusSampleName;
        appStatus.appStatusDescription = appStatusSampleDescription;
        appStatus.appStatusCreationDate = new Date();
        appStatus.appStatusUpdateDate = new Date();
        appStatus.save();

    }

}
