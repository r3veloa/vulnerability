package repositories.common.appRole;

import models.common.AppRole;
import models.common.AppStatus;
import org.junit.Test;
import play.test.WithApplication;
import repositories.common.appStatus.I_AppStatusByNameSearchable;
import repositories.common.appStatus.SearchAllAppStatusesTest;
import repositories.common.appStatus.SearchAppStatusByName;

import java.util.Date;

import static junit.framework.TestCase.assertNull;
import static org.hibernate.validator.internal.util.Contracts.assertNotNull;
import static org.junit.Assert.assertEquals;
import static play.test.Helpers.fakeApplication;
import static play.test.Helpers.inMemoryDatabase;
import static play.test.Helpers.running;

/**
 * Created by adrian on 25.07.16.
 */
public class SearchAppRoleByNameTest  extends WithApplication implements I_AppStatusByNameSearchable,
        I_AppRoleByNameSearchable {

    public String sampleAppRoleName = "sampleRole";
    public String sampleAppRoleDescription = "sample role description";
    public String sampleAppStatusName = "sample";

    public String fakeAppRole = "fake";

    @Test
    public void searchByNameTest(){

        running(fakeApplication(inMemoryDatabase("test")), () -> {

            SearchAllAppStatusesTest searchAllAppStatusesTest = new SearchAllAppStatusesTest();
            searchAllAppStatusesTest.createSampleStatus();
            createAppRole();

            AppRole appRole = searchByName(sampleAppRoleName);
            assertNotNull(appRole);
            assertEquals(appRole.appRoleName, sampleAppRoleName);
            assertEquals(appRole.appRoleDescription, sampleAppRoleDescription);

        });

    }

    @Test
    public void searchByFakeNameTest(){

        running(fakeApplication(inMemoryDatabase("test")), () -> {

            SearchAllAppStatusesTest searchAllAppStatusesTest = new SearchAllAppStatusesTest();
            searchAllAppStatusesTest.createSampleStatus();
            createAppRole();

            AppRole appRole = searchByName(fakeAppRole);
            assertNull(appRole);

        });

    }

    @Test
    public void searchByNullNameTest(){

        running(fakeApplication(inMemoryDatabase("test")), () -> {

            SearchAllAppStatusesTest searchAllAppStatusesTest = new SearchAllAppStatusesTest();
            searchAllAppStatusesTest.createSampleStatus();
            createAppRole();

            AppRole appRole = searchByName(null);
            assertNull(appRole);

        });

    }

    @Override
    public AppRole searchByName(String appRoleName) {

        SearchAppRoleByName searchAppRoleByName = new SearchAppRoleByName();
        return searchAppRoleByName.searchByName(appRoleName);

    }

    @Override
    public AppStatus searchAppStatusByName(String appStatusName) {

        SearchAppStatusByName searchAppStatusByName = new SearchAppStatusByName();
        return  searchAppStatusByName.searchAppStatusByName(appStatusName);

    }

    public void createAppRole(){

        AppRole appRole = new AppRole();
        appRole.appRoleName = sampleAppRoleName;
        appRole.appRoleDescription = sampleAppRoleDescription;
        appRole.appStatus = searchAppStatusByName(sampleAppStatusName);
        appRole.appRoleCreationDate = new Date();
        appRole.appRoleUpdateDate = new Date();
        appRole.save();

    }

}
